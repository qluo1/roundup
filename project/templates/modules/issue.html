{% from roundup import i18n%}
{% from uihelper import * %}
{% if context.is_view_ok() %}
  {% if context.is_edit_ok() %}
    <form role="form" name ="input" action="issue{{context.id}}" method="POST">
      <div class="form-group">
        <label for="title">Title</label>
        <input type="text" class="form-control" name="@title" id="title" value="{{context.title}}">
      </div>

      <div class='row'>
      <div class="col-xs-3">
        <label for='status'>status</label>
        {% raw status_html_select(context.status) %}
      </div>
      <div class="col-xs-3">
        <label for='priority'>priority</label>
        {% raw priority_html_select(context.priority) %}
      </div>
      <div class="col-xs-3">
        <label for='assignto'>assignTo</label>
        {% raw user_html_select(context.assignedto) %}
      </div>
      </div>
      <!-- Note -->
      <div class='form-group'>
        <label for='note'>{{ i18n.gettext('Note') }}</label>
          <textarea name="@note" rows="5" class='form-control' id='note' placeholder="Description of the issue"></textarea>
      </div>
      <!-- File upload -->
      <div class='form-group'>
        <label for='file_upload'>{{ i18n.gettext('File') }}</label>
          <input type="file" class='form-control' name="@file" id='file_upload'/>
      </div>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>

  {% else %}
    {% comment include 'issue.item.readonly.html' %}
  {% end %}
{% end %}

{% if context.id %}
  <p>
    Created on <b>{{ context.creation }}</b>
    by <b>{{ context.creator }}</b>,
    last changed <b>{{ context.activity }}</b>
    by <b>{{ context.actor }}</b>.
  </p>
{% end %}

{% if context.files %}
  {% comment include 'file.index.html' %}
{% end %}

{% if context.messages %}
  <h4>Messages</h4>
  {% for msg in reversed(context.messages) %}
    <div class='row-fluid'>
      <div class='span2'>
        <a href='msg{{ msg.id }}'>msg{{msg.id}} (view)</a>
      </div>
      <div class='span4'>
        Author: {{ msg.author }}, Date: {{ msg.date }}
      </div>
      <div class='pull-right'>
        {% if context.is_edit_ok %}
          <form method="POST" action='issue{{ context.id }}' class='form-inline'>
            <input type="hidden" name="@remove@messages" value='{{ msg.id }}'>
            <input type="hidden" name="@action" value="edit">
            <input type="submit" value="remove">
          </form>
        {% end %}
      </div>
    </div>
    <div class='row-fluid'>
      <pre>{{ msg.content }}</pre>
    </div>
  {% end %}
{% end %}